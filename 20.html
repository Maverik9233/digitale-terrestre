<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<title>20 Mediaset</title>
<style>
  body {
    background: #000;
    color: #fff;
    text-align: center;
    margin: 0;
    font-family: sans-serif;
  }
  h1 {
    margin: 10px 0;
  }
  iframe {
    width: 720px;
    height: 480px;
    border: 0;
  }
  table {
    margin: 20px auto;
    border-collapse: collapse;
    width: 90%;
    max-width: 800px;
    background: #111;
  }
  th, td {
    border: 1px solid #333;
    padding: 8px;
    text-align: left;
  }
  th {
    background: #222;
  }
</style>
</head>
<body>
<h1>20 Mediaset</h1>
<iframe src="https://lazzy.live/lv/it/10.php" frameborder="0" scrolling="no" allowfullscreen></iframe>

<h2>Guida TV</h2>
<table id="epg-table">
  <tr>
    <th>Orario</th>
    <th>Programma</th>
  </tr>
</table>

<script>
const xmlUrl = 'https://www.dropbox.com/s/XXXXXXXX/rytec.channels.xml?dl=1'; // <- metti qui il link diretto

fetch(xmlUrl)
  .then(response => response.text())
  .then(str => (new window.DOMParser()).parseFromString(str, "text/xml"))
  .then(data => {
    const table = document.getElementById('epg-table');
    const programs = data.querySelectorAll('programme');

    programs.forEach(p => {
      const channel = p.getAttribute('channel');
      if(channel.toLowerCase().includes('20')) { // filtriamo solo 20 Mediaset
        const start = p.getAttribute('start');
        const hours = start.substr(8,2);
        const minutes = start.substr(10,2);
        const time = `${hours}:${minutes}`;
        const titleNode = p.querySelector('title');
        const title = titleNode ? titleNode.textContent : 'Sconosciuto';

        const row = table.insertRow();
        const cell1 = row.insertCell(0);
        const cell2 = row.insertCell(1);
        cell1.textContent = time;
        cell2.textContent = title;
      }
    });
  })
  .catch(err => {
    const table = document.getElementById('epg-table');
    const row = table.insertRow();
    const cell = row.insertCell(0);
    cell.colSpan = 2;
    cell.textContent = 'Errore caricamento EPG';
    console.log('Errore EPG:', err);
  });
</script>
</body>
</html>
